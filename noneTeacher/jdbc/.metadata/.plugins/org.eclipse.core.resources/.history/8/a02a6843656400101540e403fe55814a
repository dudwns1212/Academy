package project;

import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

public class CreateList {
	Db_method db;
	
	public List<EmpInfo> executeQuery(String sql, Object... params) {// int와 String을 모두 받음
		List<EmpInfo> empList = new ArrayList<>();
		try (PreparedStatement stmt = db.conn.prepareStatement(sql)) {
				for (int i = 0; i < params.length; i++) {// setObject(i,params)로 2개 이상의 변수도 담을 수 있음
            stmt.setObject(i + 1, params[i]);
				}
				ResultSet rs = stmt.executeQuery(); 
				// while문으로 직원정보를 리스트에 담음 -> empinfo클래스에 변수가 정의되어 있음
				while(rs.next()) {
					EmpInfo emp = new EmpInfo();
					emp.employeeId = rs.getInt("employee_id");
					emp.lastName = rs.getString("last_name");
					emp.salary = rs.getInt("salary");
					emp.email = rs.getString("email");
					emp.hireDate = rs.getString("hire_date");
					emp.firstName = rs.getString("first_name");
					emp.phoneNumber = rs.getString("phone_number");
					emp.jobId = rs.getString("job_id");
					emp.managerId = rs.getString("manager_id");
					emp.departmentId = rs.getString("department_id");
					emp.commissionPct = rs.getDouble("commission_pct");
					
					empList.add(emp);
			}
		} catch (SQLException e) { // 쿼리 실행에 오류 발생 시 실패 메세지 전송
				 System.out.println("쿼리 실행 오류: " + e.getMessage());
		}
		return empList;
		}
}
